[["data-wrangling-and-summarizing.html", "Chapter 3 Data Wrangling and Summarizing 3.1 Basic R 3.2 dplyr 3.3 metan 3.4 Merge 3.5 Reshape", " Chapter 3 Data Wrangling and Summarizing body { text-align: justify} Data wrangling is one of the most important activites that you can do in R. It allows you to, sistematically, take a given data frame (or several) and set them into the format that works best for the analysis. In the last chaper, we saw already some of the most basic elements of data wrangling (like creating a new column from two other). Now, we will see a brief summary of what can be done with the native functions that come from R, as well as two specific packages: dplyr, a package specifically designed for that purpose and, metan a package designed for analyzing multienvironmental trials. 3.1 Basic R Subsetting your data. Suppose you only want to work with a section of your data frame, for example, only the data for one location. There are many ways to do this, a rather simple one is using the function subset(). soloRotonda &lt;- subset(mydata, mydata$location == &quot;Rotonda&quot;) nrow(soloRotonda) ## [1] 28 Notice how we created a new subset, only with data from Rotonda. After checking, we see it has only 28 rows, as there were only 28 plots per location.. Notice also how we used the == sign, to express a logical function stating the location had to be equal to Rotonda In R, the other characters to indicate logical expressions are: * &#39;==&#39; for equal\\ * &#39;!=&#39; for different \\ * &#39;&lt;,&gt;&#39; less than, more than \\ * &#39;&lt;=&#39; less or equal to \\ * &#39;&gt;=&#39; more or equal to \\ * &#39;&amp;&#39; if we want one condition AND another. * &quot;|&quot; if we Want one condition OR another. For example, we can select only the data for Rotonda, and only varieties A and B. If we check how many row we have now, we will see that, as expected we only have two rows, two for Var. A and 2 for Var. B. Var.AB_Rotonda &lt;- subset(mydata, mydata$location == &quot;Rotonda&quot; &amp; #And mydata$variety == &quot;Var. A&quot; | #Or mydata$location == &quot;Rotonda&quot; &amp; #And mydata$variety == &quot;Var. B&quot; ) nrow(Var.AB_Rotonda) ## [1] 4 3.2 dplyr dplyr is a package developed by the R Core Team developers, and gives us an easy and intuitive grammatic for data manipulation. We first have to install it (only once) and call it (every time you open R). install.packages(&quot;dplyr&quot;) library(dplyr) Some of the most useful functions in dplyr R are filter() # To filter rows according to criteria select() # To select only certain columns rename() # To rename columns. mutate() # TO create a new column from an old one. For example, you can create a new dataframe that contains a reduced set of variables. newdataframe &lt;- select(mydata, location, variety, yield, farmers_eval, mean_fruit_weight) Within this new data frame, you can create a new column, which converts mean fruit weight (now in kg) to grams (g), through the function mutate. newdataframe2 &lt;- mutate(newdataframe, meanfruitweight_grams = mean_fruit_weight * 1000) The pipeline %&gt;% operator. With the pipeline operator you can chain more than one operation together, instead of using temporary objects and changing them. It also allows to call my first object (mydata) only once. Here, for example, we take mydata, we select the desired columns, and we change fruit weight within the same operation. newdataframe3 &lt;- mydata %&gt;% select(location, variety, rep, mean_fruit_weight) %&gt;% mutate( meanfruitweight_grams = mean_fruit_weight * 1000) Aggregate data Finally, dplyr helps us us to calculate, for example, the mean performance of each variety per environment, given that there are two (or more) reps. For this, you have to use the group_by() and summarize (). Under group_by, we put the aggrupating facors. Under summarize, we put the columns we want, in this case, we want the means and the standard deviations . mydata_means &lt;- mydata %&gt;% #Our initial object group_by(variety, location) %&gt;% #Groupped by variety and location summarize(mean(farmers_eval), #Mean of farmer&#39;s evaluation sd(farmers_eval), #SD of farmer&#39;s evaluation mean(yield), #Mean of yield sd(yield)) #SD of yield Save your data Once you have created and modified and object, you can save it on the same folder in a .csv format. write.csv(mydata_means, &quot;tomatodata_means.csv&quot;) 3.3 metan To metan pachkage was developed by Olivoto and DalCol LÃºcio (2020) and metan stands for Multi Environmetal Trial Analysis. It counts with plenty of useful tools for the analysis of breeding trials. For now, we will see a very useful function that summarizes the information according to the criteria that you provide. As all the other packages, we need to install it and call it first. install.packages(&#39;metan&#39;) library(metan) Now, the function to summarize information in metan is means_by() and it is a bit easier to use than what we saw before in dplyr. means_by(mydata, variety) ## # A tibble: 14 x 10 ## variety plot rep row col farmers_eval yield yield_first ## * &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Var. A 13 1.5 2.5 3.62 2.77 1386. 98.4 ## 2 Var. B 13.1 1.5 2.62 3.62 2.55 1375. 93.8 ## 3 Var. C 11.8 1.5 2.25 3.38 2.57 1364. 86.3 ## 4 Var. D 10.2 1.5 2.25 3 2.73 1542. 119. ## 5 Var. E 15.5 1.5 2.5 4.25 2.84 1328. 102. ## 6 Var. F 12.9 1.5 2.38 3.62 2.64 1370. 107. ## 7 Var. G 17.4 1.5 2.38 4.75 2.62 1332. 116. ## 8 Var. H 16 1.5 2.5 4.38 2.36 1125. 162. ## 9 Var. I 13.1 1.5 2.62 3.62 2.96 1044. 68.3 ## 10 Var. J 16.8 1.5 2.75 4.5 2.56 1283. 171. ## 11 Var. K 15.5 1.5 2.5 4.25 2.6 1455. 174. ## 12 Var. L 17 1.5 2.5 4.62 2.88 1324. 137. ## 13 Var. M 16.1 1.5 2.62 4.38 2.64 1265. 131. ## 14 Var. N 14.6 1.5 2.62 4 3.12 1494. 231. ## # ... with 2 more variables: perc_mark_yield &lt;dbl&gt;, mean_fruit_weight &lt;dbl&gt; If we do not specify the variables that we want to summarize, the function will summarize all numeric variables, and that is why we see the mean for plot and repetition, altough it makes no actual sense. There are many turnarounds for this, but a very simple one would be to eliminate those rows from the data frame we will sumarize. This can be done in one move by using the brackets and minus sign. means_by(mydata[,-c(2:5)], variety) ## # A tibble: 14 x 6 ## variety farmers_eval yield yield_first perc_mark_yield mean_fruit_weight ## * &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Var. A 2.77 1386. 98.4 44.7 71.8 ## 2 Var. B 2.55 1375. 93.8 42.0 66.7 ## 3 Var. C 2.57 1364. 86.3 47.9 55.5 ## 4 Var. D 2.73 1542. 119. 40.8 76.0 ## 5 Var. E 2.84 1328. 102. 44.9 54.4 ## 6 Var. F 2.64 1370. 107. 44.7 53.5 ## 7 Var. G 2.62 1332. 116. 43.5 59.6 ## 8 Var. H 2.36 1125. 162. 45.4 54.8 ## 9 Var. I 2.96 1044. 68.3 55.9 56.1 ## 10 Var. J 2.56 1283. 171. 44.7 44.2 ## 11 Var. K 2.6 1455. 174. 45.6 84.8 ## 12 Var. L 2.88 1324. 137. 59.7 64.9 ## 13 Var. M 2.64 1265. 131. 46.9 29.7 ## 14 Var. N 3.12 1494. 231. 44.9 61.4 In addition, if we also want to summarize every combination of variety plus location, we could do it easily this way. means_by(mydata[,-c(2:5)], variety, location) ## # A tibble: 56 x 7 ## variety location farmers_eval yield yield_first perc_mark_yield ## * &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Var. A Castronuovo 2.23 452. 191. 0 ## 2 Var. A Molise 3 744. 5.5 62.2 ## 3 Var. A Rotonda 3.06 3382. 65 90.6 ## 4 Var. A Sestola 2.8 967. 132. 26.0 ## 5 Var. B Castronuovo 1.92 288. 117. 0 ## 6 Var. B Molise 3 775. 0 58.8 ## 7 Var. B Rotonda 3.16 3648 121. 82.0 ## 8 Var. B Sestola 2.12 790. 137. 27.1 ## 9 Var. C Castronuovo 1.66 259. 95.4 15.5 ## 10 Var. C Molise 3.14 1030. 22.3 64.2 ## # ... with 46 more rows, and 1 more variable: mean_fruit_weight &lt;dbl&gt; Finally, we could also take the results of this process and store them in a .csv format. means_metan &lt;- means_by(mydata[,-c(2:5)], variety, location) write.csv(means_metan , &quot;means_metan .csv&quot;) 3.4 Merge Under construction 3.5 Reshape Under construction References "]]

<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data Wrangling and Summarizing | A Participatory Plant Breeding Toolkit in R and RStudio</title>
  <meta name="description" content="Chapter 3 Data Wrangling and Summarizing | A Participatory Plant Breeding Toolkit in R and RStudio" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data Wrangling and Summarizing | A Participatory Plant Breeding Toolkit in R and RStudio" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data Wrangling and Summarizing | A Participatory Plant Breeding Toolkit in R and RStudio" />
  
  
  

<meta name="author" content="By Sergio Castro and Matteo Petitti" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="first-steps-in-r.html"/>
<link rel="next" href="basics-of-data-visualisation.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Participatory Plant Breeding Toolkit in R and RStudio</a></li> 
<img src="logo.png" width="100" height="70" style="position:center">

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html"><i class="fa fa-check"></i><b>2</b> First Steps in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#getting-started"><i class="fa fa-check"></i><b>2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#preparing-and-reading-your-data"><i class="fa fa-check"></i><b>2.2</b> Preparing and reading your data</a></li>
<li class="chapter" data-level="2.3" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#basic-data-manipulation"><i class="fa fa-check"></i><b>2.3</b> Basic data manipulation</a></li>
<li class="chapter" data-level="2.4" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#basic-statistics-and-plots"><i class="fa fa-check"></i><b>2.4</b> Basic Statistics and Plots</a></li>
<li class="chapter" data-level="2.5" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#packages-in-r."><i class="fa fa-check"></i><b>2.5</b> Packages in R.</a></li>
<li class="chapter" data-level="2.6" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#final-considerations"><i class="fa fa-check"></i><b>2.6</b> Final considerations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling and Summarizing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#basic-r"><i class="fa fa-check"></i><b>3.1</b> Basic R</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#dplyr"><i class="fa fa-check"></i><b>3.2</b> dplyr</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#metan"><i class="fa fa-check"></i><b>3.3</b> metan</a></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#merge"><i class="fa fa-check"></i><b>3.4</b> Merge</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#reshape"><i class="fa fa-check"></i><b>3.5</b> Reshape</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html"><i class="fa fa-check"></i><b>4</b> Basics of Data Visualisation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#base-package"><i class="fa fa-check"></i><b>4.1</b> Base package</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#plot-vs.-index"><i class="fa fa-check"></i><b>4.1.1</b> Plot vs.Â Index</a></li>
<li class="chapter" data-level="4.1.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#scatter-plot"><i class="fa fa-check"></i><b>4.1.2</b> Scatter plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#histogram"><i class="fa fa-check"></i><b>4.1.3</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#ggplot"><i class="fa fa-check"></i><b>4.2</b> ggplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#box-plot"><i class="fa fa-check"></i><b>4.2.1</b> Box Plot</a></li>
<li class="chapter" data-level="4.2.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#scatter-plots"><i class="fa fa-check"></i><b>4.2.2</b> Scatter plots</a></li>
<li class="chapter" data-level="4.2.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#bar-plots"><i class="fa fa-check"></i><b>4.2.3</b> Bar plots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#exporting-plots"><i class="fa fa-check"></i><b>4.3</b> Exporting plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>5</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="5.1" data-path="experimental-design.html"><a href="experimental-design.html#digger"><i class="fa fa-check"></i><b>5.1</b> DiGGer</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="experimental-design.html"><a href="experimental-design.html#randomized-complete-block-design"><i class="fa fa-check"></i><b>5.1.1</b> Randomized Complete Block Design!</a></li>
<li class="chapter" data-level="5.1.2" data-path="experimental-design.html"><a href="experimental-design.html#incomplete-block-design-ibd"><i class="fa fa-check"></i><b>5.1.2</b> Incomplete Block Design (IBD)</a></li>
<li class="chapter" data-level="5.1.3" data-path="experimental-design.html"><a href="experimental-design.html#partially-replicated-block-design"><i class="fa fa-check"></i><b>5.1.3</b> Partially Replicated Block Design</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="experimental-design.html"><a href="experimental-design.html#agricolae"><i class="fa fa-check"></i><b>5.2</b> Agricolae</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="experimental-design.html"><a href="experimental-design.html#randomized-complete-block-design-1"><i class="fa fa-check"></i><b>5.2.1</b> Randomized Complete Block Design</a></li>
<li class="chapter" data-level="5.2.2" data-path="experimental-design.html"><a href="experimental-design.html#partially-replicated-block-design-1"><i class="fa fa-check"></i><b>5.2.2</b> Partially Replicated Block Design</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="experimental-design.html"><a href="experimental-design.html#organic-trials"><i class="fa fa-check"></i><b>5.3</b> Organic Trials</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>6</b> Statistical tests</a></li>
<li class="chapter" data-level="7" data-path="spatial-analysis.html"><a href="spatial-analysis.html"><i class="fa fa-check"></i><b>7</b> Spatial Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-analysis.html"><a href="spatial-analysis.html#spats"><i class="fa fa-check"></i><b>7.1</b> SpATS</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="gge-biplots.html"><a href="gge-biplots.html"><i class="fa fa-check"></i><b>8</b> GGE BiPlots</a>
<ul>
<li class="chapter" data-level="8.1" data-path="gge-biplots.html"><a href="gge-biplots.html#metan-1"><i class="fa fa-check"></i><b>8.1</b> metan</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="gge-biplots.html"><a href="gge-biplots.html#which-won-where"><i class="fa fa-check"></i><b>8.1.1</b> Which won where</a></li>
<li class="chapter" data-level="8.1.2" data-path="gge-biplots.html"><a href="gge-biplots.html#mean-vs.-stability"><i class="fa fa-check"></i><b>8.1.2</b> Mean vs.Â Stability</a></li>
<li class="chapter" data-level="8.1.3" data-path="gge-biplots.html"><a href="gge-biplots.html#genotype-ranking"><i class="fa fa-check"></i><b>8.1.3</b> Genotype Ranking</a></li>
<li class="chapter" data-level="8.1.4" data-path="gge-biplots.html"><a href="gge-biplots.html#genotype-comparison"><i class="fa fa-check"></i><b>8.1.4</b> Genotype Comparison</a></li>
<li class="chapter" data-level="8.1.5" data-path="gge-biplots.html"><a href="gge-biplots.html#modifying-the-plot."><i class="fa fa-check"></i><b>8.1.5</b> Modifying the plot.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="climate-analogues.html"><a href="climate-analogues.html"><i class="fa fa-check"></i><b>9</b> Climate Analogues</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Participatory Plant Breeding Toolkit in R and RStudio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling-and-summarizing" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data Wrangling and Summarizing</h1>
<style>
body {
text-align: justify}
</style>
<p><img src="rsrstrip.png" /></p>
<p>Data wrangling is one of the most important activites that you can do in R. It allows you to, sistematically, take a given data frame (or several) and set them into the format that works best for the analysis. In the last chaper, we saw already some of the most basic elements of data wrangling (like creating a new column from two other). Now, we will see a brief summary of what can be done with the native functions that come from R, as well as two specific packages: <strong>dplyr</strong>, a package specifically designed for that purpose and, <strong>metan</strong> a package designed for analyzing multienvironmental trials.</p>
<div id="basic-r" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Basic R</h2>
<p><strong>Subsetting your data. </strong></p>
<p>Suppose you only want to work with a section of your data frame, for example, only the data for one location.</p>
<p>There are many ways to do this, a rather simple one is using the function subset().</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-wrangling-and-summarizing.html#cb1-1" aria-hidden="true" tabindex="-1"></a>soloRotonda <span class="ot">&lt;-</span> <span class="fu">subset</span>(mydata, mydata<span class="sc">$</span>location <span class="sc">==</span> <span class="st">&quot;Rotonda&quot;</span>)</span>
<span id="cb1-2"><a href="data-wrangling-and-summarizing.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(soloRotonda)</span></code></pre></div>
<pre><code>## [1] 28</code></pre>
<p>Notice how we created a new subset, only with data from Rotonda. After checking, we see it has only 28 rows, as there were only 28 plots per location..</p>
<p>Notice also how we used the â==â sign, to express a logical function stating the location had to be equal to âRotondaâ</p>
<p>In R, the other characters to indicate logical expressions are:<br />
</p>
<pre><code> * &#39;==&#39; for equal\
 * &#39;!=&#39; for different \
 * &#39;&lt;,&gt;&#39; less than, more than \
 * &#39;&lt;=&#39; less or equal to  \
 * &#39;&gt;=&#39; more or equal to \
 * &#39;&amp;&#39; if we want one condition AND another.
 * &quot;|&quot; if we Want one condition OR another. 
 </code></pre>
<p>For example, we can select only the data for Rotonda, and only varieties A and B. If we check how many row we have now, we will see that, as expected we only have two rows, two for Var. A and 2 for Var. B.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-wrangling-and-summarizing.html#cb4-1" aria-hidden="true" tabindex="-1"></a>Var.AB_Rotonda <span class="ot">&lt;-</span> <span class="fu">subset</span>(mydata, </span>
<span id="cb4-2"><a href="data-wrangling-and-summarizing.html#cb4-2" aria-hidden="true" tabindex="-1"></a>                  mydata<span class="sc">$</span>location <span class="sc">==</span> <span class="st">&quot;Rotonda&quot;</span></span>
<span id="cb4-3"><a href="data-wrangling-and-summarizing.html#cb4-3" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">&amp;</span>  <span class="co">#And</span></span>
<span id="cb4-4"><a href="data-wrangling-and-summarizing.html#cb4-4" aria-hidden="true" tabindex="-1"></a>                  mydata<span class="sc">$</span>variety  <span class="sc">==</span> <span class="st">&quot;Var. A&quot;</span> </span>
<span id="cb4-5"><a href="data-wrangling-and-summarizing.html#cb4-5" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">|</span>  <span class="co">#Or</span></span>
<span id="cb4-6"><a href="data-wrangling-and-summarizing.html#cb4-6" aria-hidden="true" tabindex="-1"></a>                  mydata<span class="sc">$</span>location <span class="sc">==</span> <span class="st">&quot;Rotonda&quot;</span></span>
<span id="cb4-7"><a href="data-wrangling-and-summarizing.html#cb4-7" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">&amp;</span>  <span class="co">#And</span></span>
<span id="cb4-8"><a href="data-wrangling-and-summarizing.html#cb4-8" aria-hidden="true" tabindex="-1"></a>                  mydata<span class="sc">$</span>variety  <span class="sc">==</span> <span class="st">&quot;Var. B&quot;</span> )</span>
<span id="cb4-9"><a href="data-wrangling-and-summarizing.html#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="data-wrangling-and-summarizing.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(Var.AB_Rotonda)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p><img src="rsrstrip.png" /></p>
</div>
<div id="dplyr" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> dplyr</h2>
<p>âdplyrâ is a package developed by the R Core Team developers, and gives us âan easy and intuitive grammatic for data manipulation.â We first have to install it (only once) and call it (every time you open R).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-wrangling-and-summarizing.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb6-2"><a href="data-wrangling-and-summarizing.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<p>Some of the most useful functions in dplyr R are</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data-wrangling-and-summarizing.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>() <span class="co"># To filter rows according to criteria</span></span>
<span id="cb7-2"><a href="data-wrangling-and-summarizing.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>() <span class="co"># To select only certain columns</span></span>
<span id="cb7-3"><a href="data-wrangling-and-summarizing.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>() <span class="co"># To rename columns. </span></span>
<span id="cb7-4"><a href="data-wrangling-and-summarizing.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>() <span class="co"># TO create a new column from an old one.</span></span></code></pre></div>
<p>For example, you can create a new dataframe that contains a reduced set of variables.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-wrangling-and-summarizing.html#cb8-1" aria-hidden="true" tabindex="-1"></a>newdataframe <span class="ot">&lt;-</span> <span class="fu">select</span>(mydata, location, variety, yield, farmers_eval, mean_fruit_weight)</span></code></pre></div>
<p>Within this new data frame, you can create a new column, which converts mean fruit weight (now in kg) to grams (g), through the function âmutate.â</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data-wrangling-and-summarizing.html#cb9-1" aria-hidden="true" tabindex="-1"></a>newdataframe2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newdataframe, <span class="at">meanfruitweight_grams =</span> mean_fruit_weight <span class="sc">*</span> <span class="dv">1000</span>)</span></code></pre></div>
<p><strong>The pipeline %&gt;% operator.</strong></p>
<p>With the pipeline operator you can chain more than one operation together, instead of using temporary objects and changing them. It also allows to call my first object (âmydataâ) only once. Here, for example, we take âmydata,â we select the desired columns, and we change fruit weight within the same operation.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data-wrangling-and-summarizing.html#cb10-1" aria-hidden="true" tabindex="-1"></a>newdataframe3 <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="data-wrangling-and-summarizing.html#cb10-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">select</span>(location, variety, rep, mean_fruit_weight) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="data-wrangling-and-summarizing.html#cb10-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">mutate</span>( <span class="at">meanfruitweight_grams =</span> mean_fruit_weight <span class="sc">*</span> <span class="dv">1000</span>)</span></code></pre></div>
<p><strong>Aggregate data</strong></p>
<p>Finally, dplyr helps us us to calculate, for example, the mean performance of each variety per environment, given that there are two (or more) reps.</p>
<p>For this, you have to use the group_by() and summarize (). Under group_by, we put the aggrupating facors. Under summarize, we put the columns we want, in this case, we want the means and the standard deviations
.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data-wrangling-and-summarizing.html#cb11-1" aria-hidden="true" tabindex="-1"></a>mydata_means <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span>                   <span class="co">#Our initial object</span></span>
<span id="cb11-2"><a href="data-wrangling-and-summarizing.html#cb11-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(variety, location) <span class="sc">%&gt;%</span>         <span class="co">#Groupped by variety and location</span></span>
<span id="cb11-3"><a href="data-wrangling-and-summarizing.html#cb11-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarize</span>(<span class="fu">mean</span>(farmers_eval),           <span class="co">#Mean of farmer&#39;s evaluation</span></span>
<span id="cb11-4"><a href="data-wrangling-and-summarizing.html#cb11-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">sd</span>(farmers_eval),           <span class="co">#SD of farmer&#39;s evaluation</span></span>
<span id="cb11-5"><a href="data-wrangling-and-summarizing.html#cb11-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mean</span>(yield),                <span class="co">#Mean of yield</span></span>
<span id="cb11-6"><a href="data-wrangling-and-summarizing.html#cb11-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">sd</span>(yield))                   <span class="co">#SD of yield</span></span></code></pre></div>
<p><strong>Save your data</strong></p>
<p>Once you have created and modified and object, you can save it on the same folder in a .csv format.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data-wrangling-and-summarizing.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(mydata_means, <span class="st">&quot;tomatodata_means.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="metan" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> metan</h2>
<p>To âmetanâ pachkage was developed by <span class="citation"><a href="#ref-Olivoto2020" role="doc-biblioref">Olivoto and DalâCol LÃºcio</a> (<a href="#ref-Olivoto2020" role="doc-biblioref">2020</a>)</span> and âmetanâ stands for âMulti Environmetal Trial Analysis.â It counts with plenty of useful tools for the analysis of breeding trials.</p>
<p>For now, we will see a very useful function that summarizes the information according to the criteria that you provide.</p>
<p>As all the other packages, we need to install it and call it first.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data-wrangling-and-summarizing.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;metan&#39;</span>)</span>
<span id="cb13-2"><a href="data-wrangling-and-summarizing.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metan)</span></code></pre></div>
<p>Now, the function to summarize information in metan is <em>means_by()</em> and it is a bit easier to use than what we saw before in dplyr.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-wrangling-and-summarizing.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">means_by</span>(mydata, variety)</span></code></pre></div>
<pre><code>## # A tibble: 14 x 10
##    variety  plot   rep   row   col farmers_eval yield yield_first
##  * &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
##  1 Var. A   13     1.5  2.5   3.62         2.77 1386.        98.4
##  2 Var. B   13.1   1.5  2.62  3.62         2.55 1375.        93.8
##  3 Var. C   11.8   1.5  2.25  3.38         2.57 1364.        86.3
##  4 Var. D   10.2   1.5  2.25  3            2.73 1542.       119. 
##  5 Var. E   15.5   1.5  2.5   4.25         2.84 1328.       102. 
##  6 Var. F   12.9   1.5  2.38  3.62         2.64 1370.       107. 
##  7 Var. G   17.4   1.5  2.38  4.75         2.62 1332.       116. 
##  8 Var. H   16     1.5  2.5   4.38         2.36 1125.       162. 
##  9 Var. I   13.1   1.5  2.62  3.62         2.96 1044.        68.3
## 10 Var. J   16.8   1.5  2.75  4.5          2.56 1283.       171. 
## 11 Var. K   15.5   1.5  2.5   4.25         2.6  1455.       174. 
## 12 Var. L   17     1.5  2.5   4.62         2.88 1324.       137. 
## 13 Var. M   16.1   1.5  2.62  4.38         2.64 1265.       131. 
## 14 Var. N   14.6   1.5  2.62  4            3.12 1494.       231. 
## # ... with 2 more variables: perc_mark_yield &lt;dbl&gt;, mean_fruit_weight &lt;dbl&gt;</code></pre>
<p>If we do not specify the variables that we want to summarize, the function will summarize all numeric variables, and that is why we see the âmeanâ for plot and repetition, altough it makes no actual sense. There are many turnarounds for this, but a very simple one would be to eliminate those rows from the data frame we will sumarize. This can be done in one move by using the brackets and minus sign.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data-wrangling-and-summarizing.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">means_by</span>(mydata[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], variety)</span></code></pre></div>
<pre><code>## # A tibble: 14 x 6
##    variety farmers_eval yield yield_first perc_mark_yield mean_fruit_weight
##  * &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;             &lt;dbl&gt;
##  1 Var. A          2.77 1386.        98.4            44.7              71.8
##  2 Var. B          2.55 1375.        93.8            42.0              66.7
##  3 Var. C          2.57 1364.        86.3            47.9              55.5
##  4 Var. D          2.73 1542.       119.             40.8              76.0
##  5 Var. E          2.84 1328.       102.             44.9              54.4
##  6 Var. F          2.64 1370.       107.             44.7              53.5
##  7 Var. G          2.62 1332.       116.             43.5              59.6
##  8 Var. H          2.36 1125.       162.             45.4              54.8
##  9 Var. I          2.96 1044.        68.3            55.9              56.1
## 10 Var. J          2.56 1283.       171.             44.7              44.2
## 11 Var. K          2.6  1455.       174.             45.6              84.8
## 12 Var. L          2.88 1324.       137.             59.7              64.9
## 13 Var. M          2.64 1265.       131.             46.9              29.7
## 14 Var. N          3.12 1494.       231.             44.9              61.4</code></pre>
<p>In addition, if we also want to summarize every combination of variety plus location, we could do it easily this way.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data-wrangling-and-summarizing.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">means_by</span>(mydata[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], variety, location)</span></code></pre></div>
<pre><code>## # A tibble: 56 x 7
##    variety location    farmers_eval yield yield_first perc_mark_yield
##  * &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
##  1 Var. A  Castronuovo         2.23  452.       191.              0  
##  2 Var. A  Molise              3     744.         5.5            62.2
##  3 Var. A  Rotonda             3.06 3382.        65              90.6
##  4 Var. A  Sestola             2.8   967.       132.             26.0
##  5 Var. B  Castronuovo         1.92  288.       117.              0  
##  6 Var. B  Molise              3     775.         0              58.8
##  7 Var. B  Rotonda             3.16 3648        121.             82.0
##  8 Var. B  Sestola             2.12  790.       137.             27.1
##  9 Var. C  Castronuovo         1.66  259.        95.4            15.5
## 10 Var. C  Molise              3.14 1030.        22.3            64.2
## # ... with 46 more rows, and 1 more variable: mean_fruit_weight &lt;dbl&gt;</code></pre>
<p>Finally, we could also take the results of this process and store them in a .csv format.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="data-wrangling-and-summarizing.html#cb20-1" aria-hidden="true" tabindex="-1"></a>means_metan <span class="ot">&lt;-</span> <span class="fu">means_by</span>(mydata[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], variety, location)</span>
<span id="cb20-2"><a href="data-wrangling-and-summarizing.html#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="data-wrangling-and-summarizing.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(means_metan , <span class="st">&quot;means_metan .csv&quot;</span>)</span></code></pre></div>
</div>
<div id="merge" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Merge</h2>
<p>Under construction</p>
</div>
<div id="reshape" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Reshape</h2>
<p>Under construction</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Olivoto2020" class="csl-entry">
Olivoto, and DalâCol LÃºcio. 2020. <span>âMetan: An r Package for Multi-Environment Trial Analysis.â</span> <em>Methods in Ecology and Evolution</em> 11 (6): 783â89. <a href="https://doi.org/10.1111/2041-210X.13384">https://doi.org/10.1111/2041-210X.13384</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="first-steps-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basics-of-data-visualisation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PPB Toolkit for R and R Studio.pdf", "PPB Toolkit for R and R Studio.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>

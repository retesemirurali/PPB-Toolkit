# GGE BiPlots

## metan

```{r, eval = F}
install.packages("metan")
library(metan)
```

```{r, warning = F, message =F}
library(metan)
```



```{r}
mydata <- read.csv("tomatoMLT2020.csv")
```

```{r}
gge_model <-  gge(mydata,               #data set (si possono usare anche le medie aggiustate 
                  env = location,          #colonna ambiente
                  gen = variety,      #colona genotipo
                  resp= yield,        #colona risposta o variabile
                  scaling = 1)        #Scalare con la desv. std. per normalizare i ambienti
```


```{r}
plot(gge_model)
```


#### Which won where

The "Which-Won-Where" type draws a polygon along the genotypes that are the farthest away from the origin, this means that they are the genotypes with longest vectors and are thus the most responsive. As a rule of thumb,
genotypes which are on the polygon vertex had the best performances in the environments found in the same sector (Yan et al., 2007).

```{r}
plot(gge_model, type= 3)
```

### Mean vs. Stability
The "Mean vs. Stability" feature draws a first line, the mean environmental axis, passing through the origin with an arrow representing the "ideal" environment, and then a second line perpendicular to the first,  which represents the GxE interaction.  Genotypes with projections close to the arrow in the first axis would be high performers in this ideal environment,  while large projections on the second axis indicate low stability or high GxE interaction.

```{r}
plot(gge_model, type = 2)
```


#Genotype Ranking!
# Fa un cerchio nella posizione del genotipo ideal
# Poi, piu vicino e un genotypo de questo cerchio, piu bono e
```{r}
plot(gge_model, type = 8)
```

#Genotype Comparison
# Fa una linea nel mezzo tra due genotipi, i ambiente nel latto d ogni genotipo sono quelli dove lui e andato meglio
```{r}
plot(gge_model,
     type = 9,
     sel_gen1 = "Var. A",
     sel_gen2 = "Var. L")
```    

#Modifiyng the plot.
#The GGE BiPlot is a GGplot object, so it can be easily modified.

```{r}
library(ggplot2)

plot(gge_model,
     col.gen = "black", 
     col.env = "blue",     
     size.text.env= 7,
     size.text.gen = 8,
     title =F)+
     labs(title = "GGE BIPLOT FIGO")+
     theme(axis.text.x = element_text(size= 30)) #Fino qui arriva la funzione di metan e passiamo a ggplot
  labs(title = "Yield GGE Biplot") +              #Mettere in titulo
  theme(title = element_text(size= 20),           #Cambiare la dimensioni delle intestature ed altri testi
        axis.title = element_text(size= 20),
        axis.text = element_text(size= 15))
```